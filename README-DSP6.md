# eChronos DSP6 Port

This port adds support for the custom DSP6 processor using the Synopsis toolchain.

These notes describe how to get started using the raw source.
Most of these instructions are only necessary when working directly from source and can be skipped when working from a release build.

## Building the prj tool

Before starting it is necessary to build the `prj` tool:

    py -3 .\x.py build prj

This assumes that the Python Launcher is installed (see https://www.python.org/dev/peps/pep-0397/ for more detail).

Once this is executed the `prj_build\prj` executable will be available for use.


## Ensuring chessmk is in your PATH

The build tool relies on the `chessmk` program being in your `PATH` environment variable.
You can test this by trying to directly run `chessmk` in your `cmd` or `PowerShell` terminal.

The default install location is:

    C:\Synopsys\ASIP Programmer\P-2019.09\win64\bin\WINbin

Note: On Windows 10 environment variables are access via `Control Panel` => `System and Security` => `System` => `Advanced system settings` => `Environment Variables...`.
After adding the folder to your `PATH` you will need to restart your `cmd`/`PowerShell` terminal.

## Building the hello world example

To build the hello world example project:

    .\prj_build\prj build machine-dsp6-sim.example.hello

The `prx` file path is `packages/machine-dsp6-sim/example/hello.prx`.

## Running the hello world example

To run the hello world example project:

    .\prj_build\prj run machine-dsp6-sim.example.hello

The end of the `hello.c` implementation is an infinite loop; hit Ctrl-C to exit.
Note: You will be asked if you want to `Terminate batch job`, simply type `y`.
This is due to the fact that the `prj` tool is launched via a `.bat` file.

## Debugging using ChessDE

It is possible to use the ChessDE GUI to debug the build (rather than simply using the `run` command).

The `prj` build system generates a `chessde.prx` file which can be loaded in the ChessDE GUI.

This file is located at:

    out\machine-dsp6-sim\example\hello\chessde.prx

**Note:** Do **NOT** edit files using the ChessDE GUI.
The files that are configured in the `chessde.prx` file are temporary files generated by the `prj` tool.
Any modifications using the ChessDE GUI will be lost on the next build.

**Note:** Be careful of license conflicts that may occur; you can't use the `run` command when you are actively using the debugger in ChessDE.
